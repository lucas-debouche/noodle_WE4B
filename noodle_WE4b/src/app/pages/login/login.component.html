<div class="login-page">
  <div class="login-container">
    <div class="login-image">
      <img src="../../../assets/Images/Logo_Noodle_Web.webp" alt="logo" width="150" >
    </div>

    <div class="login-header">
      <h1>Connexion</h1>
    </div>

    <div *ngIf="errorMessage" class="alert alert-danger">
      {{ errorMessage }}
    </div>

    <div *ngIf="sessionExpired" class="alert alert-danger">
      Votre session a expiré. Veuillez vous reconnecter.
    </div>

    <form [formGroup]="loginForm" (ngSubmit)="onSubmit()">
      <div class="form-group">
        <label for="email">Email</label>
        <input
          id="email"
          type="email"
          placeholder="Entrez votre email"
          class="form-control"
          formControlName="email"
          required
          autocomplete="email"
        />
        <div *ngIf="loginForm.get('email')?.errors?.['required']" class="text-danger small">❌ L'email est requis</div>
        <div *ngIf="loginForm.get('email')?.errors?.['email']" class="text-danger small">❌ L'email n'est pas valide</div>
        <div *ngIf="!loginForm.get('email')?.invalid" class="text-success small">✅ L'email valide</div>
      </div>

      <div class="form-group">
        <label for="password">Password</label>
        <div class="password-input-container">
          <input
            id="password"
            type="password"
            placeholder="Votre mot de passe"
            class="form-control"
            formControlName="password"
            required
            autocomplete="current-password"
          />
          <span class="toggle-password" id="toggleBtn" (click)="togglePassword()">👁️</span>
        </div>
        <div *ngIf="loginForm.get('password')?.errors?.['minLength']; else minLengthValid" class="text-danger small">
          ❌ Doit contenir au moins 10 caractères
        </div>
        <ng-template #minLengthValid>
          <div class="text-success small">✅ Longueur OK</div>
        </ng-template>

        <div *ngIf="loginForm.get('password')?.errors?.['uppercase']; else uppercaseValid" class="text-danger small">
          ❌ Doit contenir au moins 2 lettres majuscules
        </div>
        <ng-template #uppercaseValid>
          <div class="text-success small">✅ Majuscules OK</div>
        </ng-template>

        <div *ngIf="loginForm.get('password')?.errors?.['number']; else numberValid" class="text-danger small">
          ❌ Doit inclure au moins 1 chiffre
        </div>
        <ng-template #numberValid>
          <div class="text-success small">✅ Chiffre OK</div>
        </ng-template>

        <div *ngIf="loginForm.get('password')?.errors?.['specialChars']; else specialValid" class="text-danger small">
          ❌ Doit inclure au moins 2 caractères spéciaux
        </div>
        <ng-template #specialValid>
          <div class="text-success small">✅ Caractères spéciaux OK</div>
        </ng-template>
      </div>

      <button type="submit" class="btn-login">Se connecter</button>
    </form>

    <div class="forgot-password">
      <a href="#" (click)="forgotPassword()">Mot de passe oublié ?</a>
    </div>
  </div>

  <div class="stats-container">
    <div class="stat-box animate-stats">
      <div class="stat-icon">👨‍🎓</div>
      <div class="stat-count">{{ stats.user }}</div>
      <div class="stat-label">Utilisateur</div>
    </div>

    <div class="stat-box animate-stats">
      <div class="stat-icon">📚</div>
      <div class="stat-count">{{ stats.ue }}</div>
      <div class="stat-label">Cours & UE</div>
    </div>

    <div class="stat-box animate-stats">
      <div class="stat-icon">📩</div>
      <div class="stat-count">{{ stats.post }}</div>
      <div class="stat-label">Post</div>
    </div>
  </div>
</div>
